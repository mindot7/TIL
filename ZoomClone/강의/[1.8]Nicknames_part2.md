`JSON.stringify`ëŠ” JavaScript objectë¥¼ stringìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤

```js
// app.js

...
function makeMessage(type, payload) {
    const msg = {type, payload}
    return JSON.stringify(msg)
}
...
```



`JSON.parse`ëŠ” stringì„ JavaScript objectë¡œ ë°”ê¿”ì¤€ë‹¤

```js
// server.js

wss.on("connection", (socket) => {
    sockets.push(socket)
    console.log("Connected to Browser ğŸ‘")
    socket.on("close", () => console.log("Disconnected from Browser ğŸ˜¢"))
    socket.on("message", (message) => {
        // ì´ê²Œ ì—†ìœ¼ë©´ ul ì— [object blob]ìœ¼ë¡œ ëœ¬ë‹¤
        message = message.toString('utf-8')
        const parsed = JSON.parse(message)
        console.log(parsed, message)
        if(parsed.type === "new_message"){
            sockets.forEach((aSocket) => aSocket.send(parsed.payload))
        }
    })
})
```





*ê·¸ëŸ°ë° ì—¬ê¸°ì„œ! nicknameì€ ì¶œë ¥ë˜ì§€ ì•ŠëŠ”ë‹¤*

ìš°ì„  nicknameì´ ì¶œë ¥ë˜ê²Œë§Œ í•´ë³´ì

```js
// server.js

if(parsed.type === "new_message"){
            sockets.forEach((aSocket) => aSocket.send(parsed.payload))
        } else if(parsed.type === "nickname"){
            console.log(parsed.payload)
        }
```

- ì—¬ê¸°ì„œ, `parsed.type`ì˜ typeì€ ë©”ì‹œì§€ì˜ ì¢…ë¥˜ê³  `parsed.payload`ëŠ” ë©”ì‹œì§€ì— ë‹´ê²¨ìˆëŠ” ì¤‘ìš”í•œ ì •ë³´ë¥¼ ë§í•œë‹¤



##### switchë¥¼ ì¨ë³´ì

```js
// server.js

switch(message.type){
            case "new_message":
                sockets.forEach((aSocket) => aSocket.send(message.payload))
            case "nickname":
                console.log(message.payload)
        }
```





##### nicknameì„ socket ì•ˆì— ë„£ì–´ì£¼ì

```js
// server.js

case "nickname":
	socket["nickname"] = message.payload
```

- ìµëª… ì‚¬ìš©ìëŠ”?

  `socket["nickname"] = "ìµëª…"`

- nickname propertyë¥¼ socket objectì— ì €ì¥í•˜ì

  `case "new_message": sockets.forEach((aSocket) => aSocket.send(`${socket.nickname}: ${message.payload}`))`

